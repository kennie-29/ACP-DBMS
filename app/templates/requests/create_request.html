{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="glass-card"
        style="max-width: 800px; margin: 0 auto; padding: 2rem; border-radius: 15px; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);">
        <h2 class="mb-4 fw-bold" style="color: #1e293b;">Submit New Funding Proposal</h2>
        <form method="POST" action="{{ url_for('request.create_request') }}">

            <div class="mb-3">
                <label class="form-label fw-bold">Project Title</label>
                <input type="text" name="project_title" class="form-control" required>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">Project Site (Location)</label>
                    <input type="text" name="project_site" class="form-control" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">Project Partners</label>
                    <input type="text" name="project_partners" class="form-control" placeholder="NGOs, LGUs, etc."
                        required>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">Reason / Justification</label>
                <textarea name="reason" class="form-control" rows="3" required></textarea>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">Fund Amount Needed (PHP)</label>
                <input type="number" step="0.01" name="fund_amount" class="form-control" required>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">Start Date</label>
                    <input type="date" name="start_date" id="startDate" class="form-control" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">End Date</label>
                    <input type="date" name="end_date" id="endDate" class="form-control" required>
                </div>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg">Submit Proposal</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');

        // Set minimum date to today for Start Date
        const today = new Date().toISOString().split('T')[0];
        startDateInput.setAttribute('min', today);
        endDateInput.setAttribute('min', today);

        startDateInput.addEventListener('change', function () {
            const startVal = this.value;

            // Set End Date min to be the Start Date
            endDateInput.setAttribute('min', startVal);

            // If End Date is now invalid (before Start Date), clear it
            if (endDateInput.value && endDateInput.value < startVal) {
                endDateInput.value = '';
            }
        });
    });
</script>
{% endblock %}